# front-prop
Front propagation algorithm to obtain linear function approximations of neural networks.

Folders:

- checks: This folder has different studies and validations that we carry out related to the activation functions (AFs).
	Here we proof that the formulation of the derivatives of the AFs is correct.

- core_algo: Has the two layers of the core algorithm:

	- algo_bottom.py: lower level code to explain the predictions.
	- algo_top.py: user friendly higher level code that calls the lower level functions of algo_bottom.py.
	  Current process suggested in algo_top.py:

		1. receiving a new model by the user.
		2. loading that model to have a usable Neural Network (NN).
		3. receiving the request from the user with input data.
		4. running the NN to generate the outputs.
		5. running algo_bottom functions to get the linear function approximations for those outputs.

		Note: In order to run algo_top.py as it is coded right now, algo_bottom.py and the files inside train_gen_files folder should be in the local directory.

		Functions inside:

			display_explanation_of_instance: Display the results for a given i_instance in a user friendly format.
   
			plot_explanation_performance: Visualization of the linear function prediction vs NN prediction. See function inside for variable definition.


- docs: Additional documentation that helped creating the code.

- use_cases: Each of the folders inside is a use case: credit, diabetes, and temperature. For every use case we have:
	
	- data: Folder with the data. Has a "description.txt" document.

	- train_models: Folder with the notebook for training the model and the associated html file:

		“foo_train.ipynb”: imitates the training of a model performed by a user. 
		  
	- train_gen_files: Folder with the files generated by “foo_train.ipynb”, if Tensorflow includes:
 
    		· “user_model_parameters.h5”: Weights and biases of the NN
    		· “user_model_structure.json”: Structure of the NN
   		· “input_data_for_the_request.csv”: Data required to make a request.

	- explain_models: Folder with the notebook for generating the linear function approximations of the model and the associated html file:

		“foo_explain.ipynb”: Executes the algo_top.py to generate the linear function explanations.
		  
	
	- figures: Figures used in the Paper for the instances studied in each case.
